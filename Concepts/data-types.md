# æ•°æ®ç±»å‹

- [æ•°æ®ç±»å‹](#æ•°æ®ç±»å‹)
  - [1. ç®€ä»‹](#1-ç®€ä»‹)
  - [2. æ ‡é‡ç±»å‹](#2-æ ‡é‡ç±»å‹)
    - [2.1. æ•´æ•°](#21-æ•´æ•°)
    - [2.2. æµ®ç‚¹æ•°](#22-æµ®ç‚¹æ•°)
    - [2.3. æ•°å­—æ“ä½œ](#23-æ•°å­—æ“ä½œ)
    - [2.4. Boolean ç±»å‹](#24-boolean-ç±»å‹)
    - [2.5. å­—ç¬¦ç±»å‹](#25-å­—ç¬¦ç±»å‹)
  - [3. å¤åˆç±»å‹](#3-å¤åˆç±»å‹)
    - [3.1. Tuple](#31-tuple)
    - [3.2. Array](#32-array)
      - [3.2.1. è®¿é—®æ•°ç»„å…ƒç´ ](#321-è®¿é—®æ•°ç»„å…ƒç´ )
      - [3.2.2. æ— æ•ˆæ•°ç»„è®¿é—®](#322-æ— æ•ˆæ•°ç»„è®¿é—®)

Last updated: 2023-10-09, 21:40
@author Jiawei Mao
****

## 1. ç®€ä»‹

Rust æ˜¯é™æ€ç±»å‹è¯­è¨€ï¼Œåœ¨ç¼–è¯‘æ—¶å¿…é¡»çŸ¥é“æ‰€æœ‰å˜é‡çš„ç±»å‹ã€‚ç¼–è¯‘å™¨é€šå¸¸å¯ä»¥æ ¹æ®å€¼åŠå…¶ä½¿ç”¨æ–¹å¼æ¨æ–­å‡ºæˆ‘ä»¬æƒ³ä½¿ç”¨çš„ç±»å‹ï¼Œåœ¨å¯èƒ½æœ‰å¤šç§ç±»å‹çš„æƒ…å†µï¼Œå¿…é¡»æ·»åŠ ç±»å‹æ³¨é‡Šã€‚ä¾‹å¦‚ï¼š

```rust
let guess: u32 = "42".parse().expect("Not a number!");
```

å¦‚æœä¸åŠ  `: u32`ï¼Œä¼šæ˜¾ç¤ºå¦‚ä¸‹ç¼–è¯‘é”™è¯¯ï¼š

```rust
error[E0282]: type annotations needed        
  --> src\main.rs:10:9
   |
10 |     let guess = "42".parse().expect("Not a number!");
   |         ^^^^^
   |
help: consider giving `guess` an explicit type
   |
10 |     let guess: /* Type */ = "42".parse().expect("Not a number!");
   |              ++++++++++++

For more information about this error, try `rustc --explain E0282`.  
```

## 2. æ ‡é‡ç±»å‹

æ ‡é‡ç±»å‹è¡¨ç¤ºå•ä¸ªå€¼ã€‚Rust æœ‰ 4 ç§ä¸»è¦çš„æ ‡é‡ç±»å‹ï¼š

- æ•´æ•°
- æµ®ç‚¹æ•°
- å¸ƒå°”å€¼
- å­—ç¬¦

### 2.1. æ•´æ•°

æ•´æ•°åˆ†ä¸ºä¸¤ç§ç±»å‹ï¼š

- æ— ç¬¦å·ï¼ˆunsignedï¼‰ `u`ï¼šåªèƒ½è¡¨ç¤ºéè´Ÿæ•°
- æœ‰ç¬¦å·ï¼ˆsignedï¼‰ `i`ï¼šå¯ä»¥è¡¨ç¤ºè´Ÿæ•°

|Length|Signed|Unsigned|
|---|---|---|
|8-bit|i8|u8|
|16-bit|i16|u16|
|32-bit|i32|u32|
|64-bit|i64|u64|
|128-bit|i128|u128|
|arch|isize|usize|

- signed å­˜å‚¨**æ•°å­—èŒƒå›´**ï¼š$[-2^{n-1}, 2^{n-1}-1]$, n ä¸ºå­—èŠ‚æ•°

æ‰€ä»¥ `i8` çš„æ•°å­—èŒƒå›´ä¸º $[-2^7,2^7-1]=[-128,127]$ã€‚

- unsigned å­˜å‚¨æ•°å­—èŒƒå›´ï¼š$[0, 2^n-1]$

æ‰€ä»¥ `u8` çš„æ•°å­—èŒƒå›´ä¸º $[0, 2^8-1]=[0,255]$ã€‚

isize å’Œ usize ç±»å‹å–å†³äºè®¡ç®—æœºçš„ç»“æ„ï¼Œ64-bit æœºå™¨ä¸Šä¸º 64-bitï¼›32-bit æœºå™¨ä¸Šä¸º 32-bitã€‚

æ•´æ•°å­—é¢é‡æ”¯æŒå¦‚ä¸‹å½¢å¼ï¼š

|Number literals|Example|
|---|---|
|Decimal|`98_222`|
|Hex|`0xff`|
|Octal|`0o77`|
|Binary|`0b1111_0000`|
|Byte ( u8 only)|`b'A'`|

!!! note
    å¯ä»¥æ˜¯å¤šä¸ªæ•°å€¼ç±»å‹çš„æ•°å­—å­—é¢é‡å¯ä»¥ä½¿ç”¨åç¼€æŒ‡å®šç±»å‹ï¼Œå¦‚ `57u8`ã€‚

æ•°å­—å­—é¢é‡å¯ä»¥ç”¨ `_` ä½œä¸ºåˆ†éš”ç¬¦ï¼Œä¾¿äºé˜…è¯»ï¼Œä¾‹å¦‚ `1_000`ï¼Œä¸ `1000` å€¼ç›¸åŒã€‚

å¦å¤–ï¼š

- æ•´æ•°ç±»å‹é»˜è®¤ä¸º `i32`
- isize æˆ– usize ä¸»è¦åœ¨æŸäº›æƒ…å†µä¸ºé›†åˆå»ºç«‹ç´¢å¼•

!!! warning
    **æ•´æ•°æº¢å‡º**
    ä¾‹å¦‚ï¼Œç±»å‹ä¸º `u8` çš„å˜é‡å¯ä»¥ä¿å­˜ [0, 255] ä¹‹é—´çš„å€¼ï¼Œå°†å…¶èµ‹å€¼ä¸º 256ï¼Œå°±å‘ç”Ÿæ•´æ•°æº¢å‡ºã€‚æ•´æ•°æº¢å‡ºä¼šå‡ºç°ä¸¤ç§æƒ…å†µï¼š

    - åœ¨ debug æ¨¡å¼ï¼ŒRust ä¼šæ£€æŸ¥æ•´æ•°æº¢å‡ºï¼Œå‡ºç°æº¢å‡ºæ—¶æŠ›å‡ºå¼‚å¸¸ï¼Œç§°ä¸º *panic*
    - åœ¨ `--release` æ¨¡å¼ï¼ŒRust ä¸æ£€æŸ¥æ•´æ•°æº¢å‡ºã€‚å‘ç”Ÿæº¢å‡ºæ—¶ï¼Œå¤§äºè¯¥ç±»å‹æœ€å¤§å€¼æ—¶ä¼šç›´æ¥å–æ¨¡ã€‚åœ¨ `u8` ä¸­ï¼Œ256 å˜ä¸º 0ï¼Œ257 å˜ä¸º 1ï¼Œä¾æ­¤ç±»æ¨ã€‚
    
    æ ‡å‡†åº“ä¸ºåŸºæœ¬ç±»å‹æä¾›äº†æ˜¾å¼å¤„ç†æº¢å‡ºçš„æ–¹æ³•ï¼š
    
    - æ‰€æœ‰æ¨¡å¼ä¸‹éƒ½ wrap çš„ `wrapping_*` å‡½æ•°ï¼Œå¦‚ `wrapping_add`
    - å‡ºç°æº¢å‡ºæ—¶è¿”å› `None` çš„ `checked_*` æ–¹æ³•
    - åŒæ—¶è¿”å›å€¼å’Œè¡¨ç¤ºæ˜¯å¦æº¢å‡ºçš„ boolean å€¼çš„ `overflowing_*` æ–¹æ³•
    - åœ¨æœ€å°å€¼æˆ–æœ€å¤§å€¼å¤„é¥±å’Œçš„ `saturating_*` æ–¹æ³•

### 2.2. æµ®ç‚¹æ•°

Rust æœ‰ä¸¤ç§æµ®ç‚¹ç±»å‹ï¼š

- `f32`
- `f64`

é»˜è®¤ç±»å‹ä¸º `f64`ï¼Œå…¶é€Ÿåº¦ä¸ `f32` å¤§è‡´ç›¸åŒï¼Œä½†ç²¾åº¦æ›´é«˜ã€‚æ‰€æœ‰æµ®ç‚¹ç±»å‹éƒ½æœ‰ç¬¦å·ã€‚

```rust
fn main() {
    let x = 2.0; // f64

    let y: f32 = 3.0; // f32
}
```

### 2.3. æ•°å­—æ“ä½œ

Rust æ”¯æŒæ‰€æœ‰åŸºæœ¬æ•°å­¦è¿ç®—ï¼šåŠ å‡ä¹˜é™¤å’Œä½™æ•°ã€‚æ•´æ•°é™¤æ³•ä¼šå‘ 0 æˆªæ–­åˆ°æœ€æ¥è¿‘çš„æ•´æ•°ã€‚ä¾‹å¦‚ï¼š

```rust
fn main() {
    // addition
    let sum = 5 + 10;

    // subtraction
    let difference = 95.5 - 4.3;

    // multiplication
    let product = 4 * 30;

    // division
    let quotient = 56.7 / 32.2;
    let truncated = -5 / 3; // Results in -1

    // remainder
    let remainder = 43 % 5;
}
```

### 2.4. Boolean ç±»å‹

Boolean ç±»å‹æœ‰ 2 ä¸ªå€¼ï¼štrue å’Œ falseã€‚

Boolean ç±»å‹åªæœ‰ 1 ä¸ªå­—èŠ‚å¤§å°ï¼Œä½¿ç”¨ `bool` æ³¨é‡Šç±»å‹ã€‚

```rust
fn main() {
    let t = true;

    let f: bool = false; // with explicit type annotation
}
```

### 2.5. å­—ç¬¦ç±»å‹

`char` è¡¨ç¤ºå­—ç¬¦ç±»å‹ã€‚ç¤ºä¾‹ï¼š

```rust
fn main() {
    let c = 'z';
    let z: char = 'â„¤'; // with explicit type annotation
    let heart_eyed_cat = 'ğŸ˜»';
}
```

`char` å­—é¢é‡ä½¿ç”¨å•å¼•å·ï¼Œè€Œå­—ç¬¦ä¸²å­—é¢é‡ä½¿ç”¨åŒå¼•å·ã€‚Rust ä¸­ `char` ç±»å‹åŒ…å« 4 ä¸ªå­—èŠ‚ï¼Œä¸ Unicode æ ‡é‡å€¼å¯¹åº”ã€‚

Unicode æ ‡é‡å€¼èŒƒå›´ä¸ºï¼š[U+0000, U+D7FF] å’Œ [U+E000, U+10FFFF]ã€‚

## 3. å¤åˆç±»å‹

å¤åˆç±»å‹ï¼ˆcompound typeï¼‰å°†å¤šä¸ªå€¼ç»„åˆä¸ºä¸€ç§ç±»å‹ã€‚Rust æœ‰ä¸¤ç§åŸºæœ¬å¤åˆç±»å‹ï¼šTuple å’Œ arrayã€‚

### 3.1. Tuple

å…ƒç»„ï¼ˆtupleï¼‰å£°æ˜æ–¹å¼ï¼šæ‹¬å·ä¸­ï¼Œä»¥é€—å·åˆ†éš”å€¼ã€‚

ç¤ºä¾‹ï¼š

```rust
fn main() {
    let tup: (i32, f64, u8) = (500, 6.4, 1);
}
```

ä»å…ƒç»„è·å–å€¼ï¼ˆdestructuringï¼‰ï¼š

```rust
fn main() {
    let tup = (500, 6.4, 1);

    let (x, y, z) = tup;

    println!("The value of y is: {y}");
}
```

ä¹Ÿå¯ä»¥ç›´æ¥ç”¨ `.index` æ–¹å¼è®¿é—® tuple å€¼ï¼š

```rust
fn main() {
    let x: (i32, f64, u8) = (500, 6.4, 1);

    let five_hundred = x.0;

    let six_point_four = x.1;

    let one = x.2;
}
```

æ²¡æœ‰å€¼çš„å…ƒç»„æœ‰ä¸€ä¸ªç‰¹æ®Šåç§°ï¼š*unit*ã€‚è¯¥å€¼åŠå…¶ç±»å‹éƒ½å†™ä¸º `()`ã€‚è¡¨ç¤ºè¡¨è¾¾å¼ä¸è¿”å›ä»»ä½•å€¼ã€‚

### 3.2. Array

æ•°ç»„ï¼Œä¸å…ƒç»„ä¸åŒçš„æ˜¯ï¼šæ•°ç»„çš„æ¯ä¸ªå…ƒç´ ç±»å‹å¿…é¡»ç›¸åŒã€‚å£°æ˜æ•°ç»„æ–¹å¼ï¼š

```rust
fn main() {
    let a = [1, 2, 3, 4, 5];
}
```

å½“å¸Œæœ›å°†æ•°æ®ä¿å­˜åœ¨æ ˆè€Œä¸æ˜¯å †ä¸Šï¼Œæˆ–è€…éœ€è¦ä¿å­˜å…ƒç´ çš„æ•°é‡å›ºå®šï¼Œå°±ä½¿ç”¨æ•°ç»„ã€‚

æ•°ç»„æ²¡æœ‰ `vector` çµæ´»ï¼Œ`vector` å¯ä»¥å¢å¤§æˆ–ç¼©å°ã€‚å½“å·²çŸ¥å…ƒç´ ä¸ªæ•°ï¼Œæ¨èä½¿ç”¨æ•°ç»„ï¼š

```rust
let months = ["January", "February", "March", "April", "May", "June", "July",
              "August", "September", "October", "November", "December"];
```

å£°æ˜æ—¶æŒ‡å®šç±»å‹å’Œå¤§å°ï¼š

```rust
let a: [i32; 5] = [1, 2, 3, 4, 5];
```

å£°æ˜æ‰€æœ‰å€¼ç›¸åŒçš„æ•°ç»„ï¼š

```rust
let a = [3; 5];
```

è¡¨ç¤ºæ•°ç»„ `a` å¤§å°ä¸º 5ï¼Œæ‰€æœ‰å…ƒç´ éƒ½æ˜¯ 3ï¼Œç­‰ä»·äº `let a = [3, 3, 3, 3, 3];`ã€‚

#### 3.2.1. è®¿é—®æ•°ç»„å…ƒç´ 

- ä½¿ç”¨æ•°ç»„è®¿é—®

```rust
fn main() {
    let a = [1, 2, 3, 4, 5];

    let first = a[0];
    let second = a[1];
}
```

#### 3.2.2. æ— æ•ˆæ•°ç»„è®¿é—®

ä¸‹é¢çœ‹çœ‹ç´¢å¼•è¶…å‡ºæ•°ç»„èŒƒå›´ï¼Œä¼šæœ‰ä»€ä¹ˆæ•ˆæœï¼š

```rust
use std::io;

fn main() {
    let a = [1, 2, 3, 4, 5];

    println!("Please enter an array index.");

    let mut index = String::new();

    io::stdin()
        .read_line(&mut index)
        .expect("Failed to read line");

    let index: usize = index
        .trim()
        .parse()
        .expect("Index entered was not a number");

    let element = a[index];

    println!("The value of the element at index {index} is: {element}");
}
```

è¯¥ä»£ç ç¼–è¯‘æ²¡é—®é¢˜ï¼Œè¾“å…¥ 0, 1, 2, 3, 4ï¼Œç¨‹åºä¼šè¾“å‡ºå¯¹åº”ä½ç½®çš„å…ƒç´ å€¼ã€‚å¦‚æœè¶…å‡ºè¯¥èŒƒå›´ï¼Œä¾‹å¦‚ 10ï¼Œä¼šæ‰‹ç²—å¦‚ä¸‹é”™è¯¯ä¿¡æ¯

```
thread 'main' panicked at 'index out of bounds: the len is 5 but the index is 10',
src/main.rs:19:19
note: run with `RUST_BACKTRACE=1` environment variable to display a backtrace
```

ç¼–è¯‘æ—¶ Rust ä¸å¯èƒ½é¢„çŸ¥ä½ è¾“å…¥çš„ç´¢å¼•å€¼ï¼Œæ‰€ä»¥è¿™æ˜¯ä¸€ä¸ªè¿è¡Œæ—¶é”™è¯¯ã€‚

